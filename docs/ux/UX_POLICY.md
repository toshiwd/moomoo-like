# moomoo-like UI/UX 改善方針（桜井政博流UX × デザインシステム） v1.0

最終更新: 2026-01-06  
対象: moomoo-like（現行: Streamlit + カスタムHTML（仮想グリッド）前提）  
目的: 600銘柄超を「流し見で発見」し、気になった銘柄だけ深掘りできる“発見装置”にする

---

## 0. 結論（このプロダクトのUIの役割）
- 本アプリは「分析ツール」ではなく **発見装置**。
- 一覧では **小チャート + 重要フラグ**のみを高速に見て候補化する。
- 詳細な数値・複雑な情報は一覧に載せず、必要になった時だけ深掘りへ遷移する。
- UIの“任天堂っぽさ”は **局所（触っている要素）**に集中させ、600銘柄規模でも軽さを維持する。

---

## 1. 設計原則（桜井政博流UX / Nintendo Feel）
### 1.1 Instant Feedback（0.1秒で反応）
- クリック/キー入力の瞬間に必ず視覚フィードバック（押下の沈み、選択状態の明確化）
- 「処理完了」と「押下反応」は別設計（押した瞬間に気持ちよく、結果はトーストで知らせる）

### 1.2 “動かすのは一点だけ”（低負荷でリッチに見せる）
- アニメ対象は **選択行・候補箱・トースト**に限定
- 一覧全体や600行全体を同時にアニメしない

### 1.3 Progressive Disclosure（段階表示）
- 一覧に出すのは判断に必要な最小情報（旗は最大4）
- 詳細はホバー/右ペイン/詳細画面に退避（「読む」UIにしない）

### 1.4 Safe Destructive（破壊操作はUndo前提）
- 除外など破壊的操作は **必ずUndo（例: 5秒）**
- 派手な演出を入れるほどUndoは必須（誤操作コストをゼロに近づける）

---

## 2. 情報設計（Scan / Browse / Keep の3レイヤー）
### 2.1 Scan（一覧を流す）
- 主戦場: 600銘柄を軽量に走査する画面
- 形式: 表/仮想グリッドを維持（「全面Bentoカード化」はしない）
- 役割: “気になる”を見つける（候補箱へ入れる）

### 2.2 Browse（流し見モード）
- 役割: 疲れずに次々チャートを確認する（ランキング依存を崩す）
- 仕様: 次/前で連続巡回、キーボード中心

### 2.3 Keep（候補箱＝今日の拾い物）
- お気に入り（恒久）とは別に、**“今日の候補”**を一時保管
- 候補箱だけで巡回できる（候補→検証の導線を短くする）

---

## 3. 一覧行（Line Bento）仕様：小チャート + 旗 + アイコン
### 3.1 1行の固定レイアウト（推奨）
- 左: ミニチャート（固定サイズ）
- 中: 銘柄名（太字） + コード（薄い）
- 右: 旗バッジ最大4つ（短いラベル + 数値）
- 右端: アイコン操作（文字ボタンを基本廃止）
  - ⭐ 候補箱へ
  - 🗑 除外（Undo付き）
  - ↗ 詳細（必要な場合のみ）

### 3.2 旗（バッジ）ルール
- 表示数: 最大4（増やさない）
- 表記: `7上:12` のように短く、数字は2桁目安
- 色: 旗の種類を色で増やしすぎない（濃淡/形/ラベルで識別）
- 内部ではスコアを保持して良いが、ユーザー表示は旗が主

---

## 4. 流し見モード（Browse）仕様
### 4.1 操作（キーボード優先）
- ↑/↓ : 一覧の選択移動
- Enter : 選択銘柄を右ペインに反映（または自動反映）
- 次/前 : J/K もしくは N/P（実装時に統一）
- S : 候補箱へ追加（Save）
- E : 除外（Exclude）→ トーストでUndo

### 4.2 表示・アニメ（軽量）
- 選択行: 薄い背景 + 左アクセントバー（視線固定）
- 押下: 0.12〜0.18秒の沈み（選択行/押した要素のみ）
- ロード中:
  - 一覧は選択行に小さな取得中表示
  - 右チャートは前状態を薄く残してローディングを重ねる（真っ白禁止）

---

## 5. 候補箱（Keep）仕様
- 最大表示: 12〜24件（固定上限）
- 追加: ⭐ / S（ワンタップ）
- 削除: ×（軽量、除外とは別）
- 候補箱のみ巡回: 候補→次/前で検証できる
- 位置: 画面上部または右上（一覧より上位の視線導線）

---

## 6. 潮目スキャン（ボタン実行） + 探索ルート
### 6.1 コンセプト
- 目的: 「全銘柄チェックはできないが、潮目（遷移）は見たい」
- 方法: **前回スキャン時点との“差分（遷移）”**から、探索ルート（入口）を生成する

### 6.2 実行UI
- ボタン: `潮目をスキャン`
- 実行中: ボタン押下反応 + 短いトースト（待たせ感を消す）
- 結果: 探索ルートチップを最大7本生成（クリックで一覧を即フィルタ）

### 6.3 探索ルートの要件
- ルート数: 最大7
- ルート内銘柄: 10〜20件
- 文章ではなく「入口（チップ）」として提供（読ませない）
- ルートはユーザーの旗に直結する（一般的な株レポートは不要）

---

## 7. 業種ヒートマップ（33業種）仕様（潮目の地図）
### 7.1 軸と列
- 行: 東証33業種
- デフォルト表示: 変化が大きい業種 上位12（展開で全33）
- 列（最大4、固定デフォルト）:
  1) 初動（7上増）
  2) 天井警戒（増）
  3) ボックス接触（増）
  4) 決定打（当日/前回以降）

### 7.2 セル表示
- 表示形式: `件数（Δ）` 例: `8 (+3)`
  - 件数: 現時点の該当銘柄数（当日/前回以降）
  - Δ: 前回スキャンからの増減（潮目）
- 色: 濃淡3段階（弱/中/強）を基本
- 反対色を多用せず、疲れない配色を優先

### 7.3 クリック動作（入口化）
- セルクリック: `業種=◯◯ AND 旗=◯◯` で一覧をフィルタし、流し見モードへ
- 行クリック: 業種フィルタ
- 列クリック: 旗フィルタ（全業種横断）

### 7.4 決定打の扱い
- 表示は「決定打」1列に集約
- 内訳（当日決定打/事前決定打など）はツールチップまたは詳細に退避
- UI上は“刺さる入口”を最優先し、定義調整は設定深層へ

---

## 8. 機能の階層化（頻度による情報設計）
### レベル1（毎日使う：表に出す）
- 潮目をスキャン（ボタン）
- 業種ヒートマップ（上位12）
- 探索ルートチップ（最大7）
- 一覧（小チャート＋旗）
- 流し見（次/前、候補箱、除外、検索）

### レベル2（たまに使う：1階層深く）
- 比較基準: 前回スキャン / 前日 / 5日前
- 表示業種数: 12 / 24 / 33
- 表示旗の差し替え（最大4）

### レベル3（初期設定：さらに深く）
- 旗の定義（飯塚式の閾値・判定ロジック）
- ボックス判定パラメータ
- ショートカット割当変更
- 業種マスタの紐付け（データ整備）

---

## 9. ビジュアル / トーン（色味・統一感）
- 背景: 白ベタではなく柔らかいトーンをベース（ただし現行実装に合わせて段階導入）
- 文字: 純黒は避け、可読性重視（見出し濃く、本文薄め）
- 角丸: “押せる感”が出る丸み（過剰に尖らせない）
- CTA（主要アクション）だけ強調色、旗や情報は抑制して疲れにくくする
- 色の意味は固定（成功/注意/破壊など）し、場面で変えない

---

## 10. パフォーマンス方針（600銘柄前提）
- 一覧は仮想化を維持（DOMを増やさない）
- アニメは transform / opacity 系に限定（レイアウト再計算を誘発しない）
- 影/ブラーの多用禁止（特に動く影は避ける）
- 更新は局所（選択要素・候補箱・トーストのみ）
- 並び替え時に全要素アニメはしない（重くなりやすい）

---

## 11. 受け入れ条件（Definition of Done）
1) 600銘柄規模でスクロール・並び替え・フィルタが体感で重くならない
2) 一覧行が「小チャート＋旗＋アイコン」に統一され、旗は最大4
3) 流し見モードで次/前が成立し、候補箱へ一発で入れられる
4) 潮目スキャンで探索ルートが生成され、クリックで一覧フィルタ + 流し見へ遷移できる
5) 業種ヒートマップ（33業種）が入口として機能し、決定打列が使える
6) 除外は必ずUndo可能（例: 5秒）
7) チャートの基礎機能（描画・データ取得）を壊さず、UI改善が独立している

---

## 12. 実装ロードマップ（壊さず段階導入）
Phase 1: 一覧行の統一（小チャート＋旗＋アイコン）、選択状態の明確化  
Phase 2: 流し見モード（次/前 + ショートカット + 候補箱）  
Phase 3: 除外 + Undo + トースト（安心して操作できる）  
Phase 4: 潮目スキャン（差分から探索ルート生成）  
Phase 5: 33業種ヒートマップ（入口化、決定打対応）  
Phase 6: 設定の階層化（頻度ベース）、旗定義の整理（深層へ）

---

## 13. 非目標（今回やらないこと）
- UIスタック全移行（Next.js化など）は必須要件ではない（現行の軽さ・基礎機能維持を優先）
- 一覧に詳細データを過剰に載せること（読むUIにしない）
- 600銘柄全体の派手アニメ（体感性能を落とす）

---

## 14. 付記：比較基準（デフォルト）
- 潮目スキャンの比較は **前回スキャン**をデフォルト（“押した瞬間の潮目”が取れる）
- 前回がない場合は前日でフォールバック
